(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(30)},24:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(10),o=a.n(i),c=(a(24),a(1)),l=a(2),s=a(4),d=a(3),u=a(5),p=a(8),g=a(6),h=(a(29),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).progressLoader=a.progressLoader.bind(Object(p.a)(a)),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=window.L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:20,attribution:"OpenStreetMap"}),t=window.L.latLng(12.92415,77.67229);this.map=window.L.map("map",{center:t,zoom:13,layers:[e],scrollWheelZoom:!1}),this.markers=window.L.markerClusterGroup({chunkedLoading:!0,chunkProgress:this.progressLoader})}},{key:"shouldComponentUpdate",value:function(e){var t=this;if(e.state){var a=[],n=e.state.json.allIds;e.state.currentFilter&&(n=e.state.filtered[e.state.currentFilter.type][e.state.currentFilter.id]),this.markers.clearLayers(),n.map(function(t){var n=e.state.json.data[t],r=n.from_lat,i=n.user_id,o=n.from_long,c=n.to_lat,l=n.to_long,s=n.from_date,d=n.vehicle_model_id;if(r&&o){var u=new window.L.marker([r,o],{id:t,user_id:i,to_lat:c,to_long:l,from_date:s,vehicle_model_id:d});a.push(u)}});var r=window.L.icon({iconUrl:"https://png.pngtree.com/svg/20170502/91a8305b9c.png",iconSize:[45,45],iconAnchor:[22,64],shadowAnchor:[4,22],popupAnchor:[-3,-36]}),i=window.L.popup();this.markers.addLayers(a),this.map.addLayer(this.markers),this.markers.on("click",function(e){var a=e.layer.options,n=a.user_id,o=a.to_lat,c=a.to_long,l=a.from_date,s=a.to_date,d=a.id;t.destinationMarker&&t.map.removeLayer(t.destinationMarker),o&&c&&(t.destinationMarker=new window.L.marker([o,c],{icon:r}).addTo(t.map));var u=new window.L.featureGroup([t.destinationMarker,e.target]);t.map.fitBounds(u.getBounds()),i.setLatLng(e.latlng).setContent("Booking Id : ".concat(d," <br> Start Time : ").concat(l," <br> End Time : ").concat(s||"Unknown"," <br> User Id: ").concat(n," ").concat(o&&c?"":"<br> Destination: Unknown")).openOn(t.map)}),this.map.on("click",function(){t.destinationMarker&&t.map.removeLayer(t.destinationMarker)});var o=new window.L.featureGroup(a);this.map.fitBounds(o.getBounds())}return!1}},{key:"progressLoader",value:function(e,t,a,n){a>1e3&&console.log(" ==================== loading : ",Math.round(e/t*100)+"%")}},{key:"render",value:function(){return r.a.createElement("div",{id:"map"})}}]),t}(r.a.Component)),m=Object(g.b)(function(e){return{state:e}})(h),k=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(d.a)(t).call(this,e))).onChangeHandler=a.onChangeHandler.bind(Object(p.a)(a)),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"onChangeHandler",value:function(e){var t=e.target.files[0],a=new FileReader,n=this;a.onload=function(e){var t=e.target.result;n.props.getData(t)},a.readAsText(t)}},{key:"render",value:function(){return r.a.createElement("div",{style:{float:"right",display:"inline-block",paddingTop:"30px"}},this.props.state&&this.props.state.currentFilter&&r.a.createElement("button",{className:"btn btn-default",style:{margin:"10px 10px 10px 0"},onClick:this.props.resetFilters},"Reset Filters"),!this.props.state&&r.a.createElement("input",{id:"selectFileButton",type:"file",accept:".csv, text/csv",multiple:"",onChange:this.onChangeHandler}))}}]),t}(r.a.Component),f=Object(g.b)(function(e){return{state:e}},function(e){return{getData:function(t){e({type:"STORE_DATA",payload:t})},resetFilters:function(){e({type:"RESET_FILTER"})}}})(k),b=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.params,a=t.id,n=t.data,r=t.categories,i=e.callback;window.Highcharts.chart(a,{chart:{type:"column"},title:{text:""},xAxis:{categories:r},yAxis:{min:0,title:{text:"Percent"},stackLabels:{enabled:!0,style:{fontWeight:"bold",color:window.Highcharts.theme&&window.Highcharts.theme.textColor||"gray"}}},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: {point.y}<br/>Total: {point.stackTotal}"},plotOptions:{column:{stacking:"percent",dataLabels:{enabled:!0,color:window.Highcharts.theme&&window.Highcharts.theme.dataLabelsColor||"white"},point:{events:{click:function(){i(this.id)}}}}},credits:{enabled:!1},series:n})}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.params.id,style:{width:500,height:300}})}}]),t}(r.a.Component),y=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.params,a=t.title,n=t.id,r=t.data,i=e.callback;window.Highcharts.chart(n,{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},title:{text:a},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0,point:{events:{click:function(){i(this.id)}}}}},credits:{enabled:!1},series:r})}},{key:"render",value:function(){return r.a.createElement("div",{id:this.props.params.id,style:{width:450,height:200}})}}]),t}(r.a.Component),v={1:"Package 1",2:"Package 2",3:"Package 3",4:"Package 4",5:"Package 5",6:"Package 6",7:"Package 7",others:"Others"},O={1:"Long distance",2:"Point to Point",3:"Hourly rental"},w={0:"Others",1:"Desktop"},_=function(e,t){return{id:"Packages",data:[{name:"Successfull Booking",data:Object.keys(e).map(function(a){return{y:e[a].length-t[a].length,id:a}}),index:1,id:"package_id"},{name:"Cancelled",data:Object.keys(t).map(function(e){return{y:t[e].length,id:e}}),color:"red",index:0,id:"cancelledPackageBookings"}],title:"Packages",categories:["Package 1","Package 2","Package 3","Package 4","Package 5","Package 6","Package 7","Others"]}},j=function(e){var t={};Object.keys(e).map(function(a){t[a]=[],Object.keys(e[a]).map(function(n){t[a].push(e[a][n].length)})});return{id:"travelPacks",data:[{name:"Long Distance",data:t[1]},{name:"Point to Point",data:t[2]},{name:"Hourly Rental",data:t[3]}],title:"",categories:["Package 1","Package 2","Package 3","Package 4","Package 5","Package 6","Package 7","Others"]}},P=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t,a,n=this.props,i=n.data,o=n.getData;return i?r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("h3",{style:{textAlign:"center"}},"Package bookings"),r.a.createElement(y,{callback:function(e){return o({type:"package_id",id:e})},params:(a=i.package_id,{id:"packagePie",data:[{name:"Packages",colorByPoint:!0,data:Object.keys(a).map(function(e){return{name:v[e],y:a[e]?a[e].length:0,id:e}})}],title:""})})),r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("h3",{style:{textAlign:"center"}},"Bookings for different travel types"),r.a.createElement(y,{callback:function(e){return o({type:"travel_type_id",id:e})},params:(t=i.travel_type_id,{id:"travelChart",data:[{name:"Travel",colorByPoint:!0,data:Object.keys(t).map(function(e){return{name:O[e],y:t[e]?t[e].length:0,id:e}})}],title:""})})),r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("h3",{style:{textAlign:"center"}},"Online Booking"),r.a.createElement(y,{callback:function(e){return o({type:"online_booking",id:e})},params:(e=i.online_booking,{id:"onlineBooking",data:[{name:"Online booking",colorByPoint:!0,data:Object.keys(e).map(function(t){return{name:w[t],y:e[t]?e[t].length:0,id:t}})}],title:""})})),r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("h3",{style:{textAlign:"center"}},"Cancellation per package"),r.a.createElement(b,{callback:function(e){return console.log(e)},params:_(i.package_id,i.cancelledPackageBookings)})),r.a.createElement("div",{style:{display:"inline-block"}},r.a.createElement("h3",{style:{textAlign:"center"}},"Travel type in each package"),r.a.createElement(b,{callback:function(e){return console.log(e)},params:j(i.travelPerPackage)}))):null}}]),t}(r.a.Component),E=Object(g.b)(function(e){return{data:e?e.filtered:null}},function(e){return{getData:function(t){e({type:"FILTER_POINT",payload:t})}}})(P),L=a(11),x=a(15),C=/\r?\n/,T=function(e){if(e.length>0)for(var t=0;t<e.length;t++)if(e[t])return!0;return!1},B=function(e){return e.replace(/\s/g,"")},F=function(e){return!isNaN(e)?Number(e):"NULL"===e?null:String(e)},A=function(e,t){for(var a={},n=0;n<e.length;n++){var r=B(e[n]),i=t[n];i=F(t[n]),a[r]=i}return a},I=["user_id","package_id","vehicle_model_id","travel_type_id","from_area_id","to_area_id","from_city_id","to_city_id","online_booking","mobile_site_booking","Car_Cancellation"],D=function(e){var t=function(e,t){var a=e.split(C),n=a[0].split(","),r={data:{},allIds:[],length:0},i={},o={};t.forEach(function(e){o[e]={}});for(var c=1;c<a.length;c++){var l=a[c].split(",");T(l)&&(i=A(n,l),r.data[i.id]=i,r.allIds.push(i.id),r.length+=1,t.forEach(function(e){var t=null===i[e]?"others":i[e];o[e][t]=o[e][t]||[],o[e][t].push(i.id)}))}return{json:r,filtered:o}}(e,I),a={},n={};return Object.keys(t.filtered.package_id).map(function(e){var r=t.filtered.package_id[e];a[e]=r.filter(function(e){return-1!==t.filtered.Car_Cancellation[1].indexOf(e)}),Object.keys(t.filtered.travel_type_id).map(function(a){n[a]||(n[a]={}),n[a][e]=r.filter(function(e){return-1!==t.filtered.travel_type_id[a].indexOf(e)})})}),t.filtered.travelPerPackage=n,t.filtered.cancelledPackageBookings=a,console.log("generalisedData",t),t},H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"STORE_DATA":return D(t.payload);case"FILTER_POINT":return Object(x.a)({},e,{currentFilter:{type:t.payload.type,id:t.payload.id}});case"RESET_FILTER":return Object(x.a)({},e,{currentFilter:null});default:return e}},M=Object(L.b)(H),R=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(g.a,{store:M},r.a.createElement("div",{className:"App"},r.a.createElement("div",{style:{display:"inline-block",width:"100%"}},r.a.createElement("h1",{style:{display:"inline-block"}},"Interactive Map demo"),r.a.createElement(f,null)),r.a.createElement(m,null),r.a.createElement(E,null)))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[19,1,2]]]);
//# sourceMappingURL=main.b95c3d77.chunk.js.map